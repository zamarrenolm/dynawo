<?xml version='1.0' encoding='UTF-8'?>

<dyn:dynamicModelsArchitecture xmlns:dyn="http://www.rte-france.com/dynawo">

 <dyn:blackBoxModel id="InfiniteBus" lib="InfiniteBus" parFile="test.par" parId="InfiniteBus"/>
 
 <!--<dyn:blackBoxModel id="Line" lib="Line" parFile="test.par" parId="Line"/>
 
 <dyn:blackBoxModel id="Transformer" lib="TransformerFixedRatio" parFile="test.par" parId="Transformer"/>-->
 

 
 
 <dyn:modelicaModel id="CONVERTER">
 
   <dyn:unitDynamicModel id="converter" name="Converter3" moFile="Converter3.mo" parFile="test.par" parId="convpar"/>  
 
  <dyn:unitDynamicModel id="measurements" name="Measurements2" moFile="Measurements2.mo" parFile="test.par" parId="measurepar"/>
 
  <dyn:unitDynamicModel id="currentloop" name="CurrentLoop3" moFile="CurrentLoop3.mo" parFile="test.par" parId="clooppar"/>
  
  <dyn:unitDynamicModel id="outerloop" name="OuterLoop2" moFile="OuterLoop2.mo" parFile="test.par" parId="outpar"/>
  
  <dyn:unitDynamicModel id="PREF" name="Dynawo.Electrical.Controls.Basics.Step" parFile="test.par" parId="StepPref"/>
  
  <dyn:unitDynamicModel id="QREF" name="Dynawo.Electrical.Controls.Basics.Step" parFile="test.par" parId="StepQref"/>
  
  
  
  
  
  <dyn:connect id1="currentloop" var1="vqref" id2="converter" var2="vqConv"/>
  <dyn:connect id1="currentloop" var1="vdref" id2="converter" var2="vdConv"/>
  <dyn:connect id1="outerloop" var1="Pref" id2="PREF" var2="step.value" /> 
  <dyn:connect id1="outerloop" var1="Qref" id2="QREF" var2="step.value"/>     
  <dyn:connect id1="outerloop" var1="iqref" id2="currentloop" var2="iqref"/> 
  <dyn:connect id1="outerloop" var1="idref" id2="currentloop" var2="idref"/>   
  <dyn:connect id1="measurements" var1="omega" id2="converter" var2="omegaPu"/> 
  <dyn:connect id1="measurements" var1="theta" id2="converter" var2="theta"/> 
  <dyn:connect id1="measurements" var1="vqr" id2="currentloop" var2="vq"/> 
  <dyn:connect id1="measurements" var1="vdr" id2="currentloop" var2="vd"/> 
  <dyn:connect id1="measurements" var1="iqr" id2="currentloop" var2="iq"/> 
  <dyn:connect id1="measurements" var1="idr" id2="currentloop" var2="id"/> 
  <dyn:connect id1="measurements" var1="omega" id2="currentloop" var2="omegaPu"/> 
  <dyn:connect id1="measurements" var1="omega" id2="outerloop" var2="omegaPu"/>   
  <dyn:connect id1="converter" var1="vqFilter" id2="measurements" var2="vq"/> 
  <dyn:connect id1="converter" var1="vdFilter" id2="measurements" var2="vd"/>
  <dyn:connect id1="converter" var1="iqConv" id2="measurements" var2="iq"/> 
  <dyn:connect id1="converter" var1="idConv" id2="measurements" var2="id"/>  
  <dyn:connect id1="outerloop" var1="vq" id2="measurements" var2="vqr"/> 
  <dyn:connect id1="outerloop" var1="iq" id2="measurements" var2="iqr"/> 
  <dyn:connect id1="outerloop" var1="id" id2="measurements" var2="idr"/> 
  
  
 </dyn:modelicaModel>
  
 <dyn:connect id1="InfiniteBus" var1="infiniteBus_terminal" id2="CONVERTER" var2="converter_terminal"/>
 <!--<dyn:connect id1="Transformer" var1="transformer_terminal1" id2="CONVERTER" var2="converter_terminal"/>
 <dyn:connect id1="Transformer" var1="transformer_terminal2" id2="Line" var2="line_terminal1"/>-->
</dyn:dynamicModelsArchitecture>
